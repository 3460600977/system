webpackJsonp([4],{642:function(t,e,l){l(786);var a=l(319)(l(680),l(775),"data-v-1d6ef9c1",null);t.exports=a.exports},648:function(t,e,l){"use strict";var a=l(320),s=l.n(a),i=l(67),n=l.n(i),o={isJSON:function(t){return"object"===(void 0===t?"undefined":n()(t))&&"[object object]"===Object.prototype.toString.call(t).toLowerCase()&&!t.length},stringify:function(t){return void 0===t||"function"==typeof t?t+"":s()(t)},isPhone:function(t){return/^1\d{10}$/.test(t)},deserialize:function(t){if("string"==typeof t)try{return JSON.parse(t)}catch(e){return t||void 0}},isFunction:function(t){return"[object Function]"==={}.toString.call(t)},isArray:function(t){return t instanceof Array},islocalStorage:function(){return!!window.localStorage},isCode:function(t){return/^\d{6}$/.test(t)},setStore:function(t,e){if(this.islocalStorage){if(t&&!this.isJSON(t))window.localStorage.setItem(t,this.stringify(e));else if(t&&this.isJSON(t)&&!e)for(var l in t)this.setStore(l,t[l])}else console.log("浏览器不支持localStorage(setStore)")},getStore:function(t){if(this.islocalStorage){if(!t)throw new Error("getStore参数不存在");return this.deserialize(window.localStorage.getItem(t))}console.log("浏览器不支持localStorage(getStore)")},delStore:function(t){if(this.islocalStorage){if(!t)throw new Error("delStore参数不存在");window.localStorage.removeItem(t)}else console.log("浏览器不支持localStorage(getStore)")},clearStore:function(){this.islocalStorage?window.localStorage.clear():console.log("浏览器不支持localStorage(clearStore)")},getCookie:function(t){var e,l=new RegExp("(^| )"+t+"=([^;]*)(;|$)");return(e=document.cookie.match(l))?unescape(e[2]):null},formateYYYYMMDD:function(t){var e;e=t?new Date(t):new Date;var l=e.getFullYear(),a=e.getMonth()+1,s=e.getDate(),i=e.getHours(),n=e.getMinutes();return 1==n.toString().length&&(n="0"+n),l+"-"+a+"-"+s+" "+i+":"+n},formateDate:function(t){var e;return e=t?new Date(t):new Date,e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()},formateDateNoDelimiter:function(t){var e=new Date(t),l=e.getFullYear(),a=e.getMonth()+1,s=e.getDate();return 1==a.toString().length&&(a="0"+a),1==s.toString().length&&(s="0"+s),l+a+s}};e.a=o},649:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD8AAAAmCAYAAABzhkOMAAAA50lEQVRogWP8DwQMIxQwDbQDBhKwDLQD6AE8F7xhuPbyF5itJc7GsD1BBMweETEP8zg6e0R4HhcY9fxIBaOeH6lgWFR1uKoyQmBYxDyuqowQGBaeJxeMaM/TJc+TmydpDegS8+TmSVqDEZ3sRz0/UsGI9vyQaOHRqrYYEjFPq9piSHieVmBEe56oPD9YW2iUAqJifrC20CgFo8l+uCZrQgAc88M1WRMCIzrZj2jPD4rm7UCVOYMi5geqzBkUnh8oMOr5kQpGPQ8qYWFAS4wVQxEh+YjlbxjkO5+BMYhNqv6BkmccyQuSAEFgYzXUcxg0AAAAAElFTkSuQmCC"},651:function(t,e,l){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=l(648);e.default={props:{tit:{type:String,required:!0},nav:{type:String}},data:function(){return{teamId:"",glob:0,count:0}},mounted:function(){this.teamId=a.a.getStore("teamId"),this.getTeamInfo(),window.scrollTo(0,0)},methods:{getTeamInfo:function(){var t=this;t.postData({url:ApiUrl.getTeamInfo+"?teamId="+this.teamId,success:function(e){0==e.status&&(t.glob=e.data.glob,t.count=e.data.totalMoney)}})}}}},652:function(t,e,l){e=t.exports=l(90)(!1),e.push([t.i,'.page-titles[data-v-0358e23a]{background:#fff;margin:0 -30px 30px;padding:15px;-webkit-box-shadow:1px 0 5px rgba(0,0,0,.1);box-shadow:1px 0 5px rgba(0,0,0,.1)}.page-titles h3[data-v-0358e23a]{margin-top:8px}.page-titles .breadcrumb[data-v-0358e23a]{padding:0;background:transparent;font-size:14px}.page-titles .breadcrumb li[data-v-0358e23a]{margin-top:0;margin-bottom:0}.page-titles .breadcrumb .breadcrumb-item+.breadcrumb-item[data-v-0358e23a]:before{content:"\\E649";font-family:themify;color:#a6b7bf;font-size:11px}.page-titles .breadcrumb .breadcrumb-item.active[data-v-0358e23a]{color:#99abb4}',""])},653:function(t,e,l){l(655);var a=l(319)(l(651),l(654),"data-v-0358e23a",null);t.exports=a.exports},654:function(t,e,l){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row page-titles"},[a("div",{staticClass:"col-md-5 col-8 align-self-center"},[a("h3",{staticClass:"mb1"},[t._v(t._s(t.tit))])]),t._v(" "),a("div",{staticClass:"col-md-7 col-4 align-self-center"},[a("div",{staticClass:"d-flex m-t-10 justify-content-end"},[a("div",{staticClass:"d-flex mr2 ml1"},[a("div",{staticClass:"chart-text mr1 mr2"},[a("img",{staticClass:"left mt1 mr1",attrs:{src:l(649)}}),t._v(" "),a("div",{staticClass:"left"},[t._m(0),t._v(" "),a("h4",{staticClass:"mt0 text-info"},[t._v("￥"+t._s(t.glob))])])])]),t._v(" "),a("div",{staticClass:"d-flex mr2 ml1"},[a("div",{staticClass:"chart-text mr1"},[a("img",{staticClass:"left mt1 mr1",attrs:{src:l(649)}}),t._v(" "),a("div",{staticClass:"left"},[t._m(1),t._v(" "),a("h4",{staticClass:"mt0 text-primary"},[t._v("￥"+t._s(t.count))])])])])])])])},staticRenderFns:[function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("h6",{staticClass:"mb0 font18"},[l("small",[t._v("月目标")])])},function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("h6",{staticClass:"mb0 font18"},[l("small",[t._v("已成交")])])}]}},655:function(t,e,l){var a=l(652);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);l(318)("111e6cd8",a,!0)},657:function(t,e,l){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=l(320),s=l.n(a),i=l(648);e.default={props:{showadd:Boolean,id:Number},data:function(){return{teamid:"",filedList:[],ruleForm:{name:"",phone:"",state:1,customUserLabel:""},rules:{name:[{required:!0,message:"姓名不能为空",trigger:"blur"}],phone:[{required:!0,message:"电话不能为空",trigger:"blur"}],customUserLabel:[{required:!0,message:"标签必须选择哦",trigger:"blur"}]},time:"",labelList:[],visibleLabel:!1,labelTag:!1}},mounted:function(){this.teamId=i.a.getStore("teamId").toString(),this.getFiled(),this.getLabelList()},watch:{id:function(){this.getRelation()}},methods:{getRelation:function(){var t=this;t.postData({url:ApiUrl.getRelationDetail+"?relationShipId="+this.id,success:function(e){if(0==e.status){if(t.ruleForm.name=e.data.customName,t.ruleForm.phone=e.data.customPhone,t.ruleForm.state=e.data.shareState,t.time=e.data.customTime,null!=e.data.customUserLabel&&""!=e.data.customUserLabel){var l=t.labelList,a=JSON.parse(e.data.customUserLabel);t.labelTag=!0;for(var s in l){l[s].lebelIndex=-1;for(var i in l[s].lebelContent)for(var n in a)a[n].lebelContent==l[s].lebelContent[i]&&(l[s].lebelIndex=a[n].lebelIndex)}}else t.labelTag=!1;if(null!=e.data.customInfo&&""!=e.data.customInfo){var o=JSON.parse(e.data.customInfo);for(var s in o)for(var i in t.filedList)o[s].name==t.filedList[i].name&&(t.filedList[i].value=o[s].value)}}}})},getFiled:function(){var t=this;this.teamid&&t.postData({url:ApiUrl.getfield+"?teamId="+this.teamid,success:function(e){0==e.status&&(t.filedList=JSON.parse(e.data.idText))}})},getLabelList:function(){var t=this;t.postData({url:ApiUrl.getLabels,success:function(e){if(0==e.status&&null!=e.data){var l=e.data;for(var a in l)null!=l[a].lebelContent&&""!=l[a].lebelContent&&(l[a].lebelIndex=-1,l[a].lebelContent=l[a].lebelContent.split(",")),"状态"==l[a].lebelName&&(""==l[a].lebelContent&&(l[a].lebelContent=[]),l[a].lebelContent.push("成交"),l[a].lebelContent.push("流失"));t.labelList=l}console.log(t.id),t.id&&t.getRelation()}})},choiceCustomLabel:function(t,e){this.$set(this.labelList[t],"lebelIndex",e)},choiceState:function(t){this.ruleForm.state=t},addLabel:function(){this.visibleLabel=!0},getDot:function(t){return t?"，":""},confirmLabel:function(){this.labelTag=!0,this.ruleForm.customUserLabel="true",this.visibleLabel=!1},inputValue:function(t,e){this.filedList[t].value=e},submitForm:function(t){var e=this,l=this;l.$refs[t].validate(function(t){if(!t)return console.log("error submit!!"),!1;var a=JSON.parse(s()(l.ruleForm)),i=[];for(var n in e.labelList)-1!=e.labelList[n].lebelIndex&&void 0!=e.labelList[n].lebelIndex&&(i.push({lebelId:e.labelList[n].lebelId,lebelIndex:e.labelList[n].lebelIndex,lebelContent:e.labelList[n].lebelContent[e.labelList[n].lebelIndex],lebelColor:e.labelList[n].lebelColor}),"成交"==i[n].lebelContent?a.label=1:"流失"==i[n].lebelContent&&(a.label=-1));if(e.filedList.length>0){var o=[];for(var n in e.filedList)e.filedList[n].value&&o.push({required:e.filedList[n].required,name:e.filedList[n].name,value:e.filedList[n].value});a.customInfo=s()(o)}a.customUserLabel=s()(i),a.teamId=e.teamid,e.time&&(a.time=new Date(e.time).getTime()),e.id||l.postData({url:ApiUrl.addCustomer,type:"post",data:s()(a),success:function(t){0==t.status?(l.$message({message:"添加成功",type:"success"}),l.showadd=!1,l.handleClose(),l.ruleForm.name="",l.ruleForm.phone="",l.ruleForm.state=1,l.ruleForm.customUserLabel="",l.labelTag=!1):l.$message({message:t.message,type:"warning"})}})})},handleClose:function(){this.$emit("watchshow")}}}},658:function(t,e,l){e=t.exports=l(90)(!1),e.push([t.i,"",""])},659:function(t,e,l){l(661);var a=l(319)(l(657),l(660),"data-v-bd3d2202",null);t.exports=a.exports},660:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("el-dialog",{attrs:{title:"添加客户",visible:t.showadd,width:"450px","before-close":t.handleClose,"append-to-body":"true"},on:{"update:visible":function(e){t.showadd=e}}},[l("el-form",{ref:"ruleForm",staticClass:"sett-for mb2",staticStyle:{height:"500px"},attrs:{model:t.ruleForm,rules:t.rules,"label-position":"right","label-width":"93px"}},[l("el-form-item",{attrs:{prop:"name",label:"名字："}},[l("el-input",{staticClass:"login-input",attrs:{placeholder:"输入姓名"},model:{value:t.ruleForm.name,callback:function(e){t.$set(t.ruleForm,"name",e)},expression:"ruleForm.name"}})],1),t._v(" "),l("el-form-item",{attrs:{prop:"phone",label:"电话："}},[l("el-input",{staticClass:"login-input",attrs:{type:"number",placeholder:"输入电话"},model:{value:t.ruleForm.phone,callback:function(e){t.$set(t.ruleForm,"phone",e)},expression:"ruleForm.phone"}})],1),t._v(" "),t._l(t.filedList,function(e,a){return l("el-form-item",{attrs:{label:e.name}},[l("el-input",{staticClass:"login-input",attrs:{placeholder:"输入"+e.name},on:{input:function(e){t.inputValue(a,e)}}})],1)}),t._v(" "),l("el-form-item",{attrs:{prop:"customUserLabel",label:"标签："}},[t.labelTag?[l("div",{on:{click:t.addLabel}},t._l(t.labelList,function(e,a){return-1!=e.lebelIndex?l("span",{staticClass:"tips"},[0!=a?[t._v("，")]:t._e(),t._v("\n\t\t            \t\t"+t._s(e.lebelContent[e.lebelIndex])+"\n\t\t            \t")],2):t._e()}))]:[l("span",{staticClass:"colp pointer",on:{click:t.addLabel}},[l("i",{staticClass:"fa fa-plus-square-o ml2 mr1 font16"}),t._v("添加标签")])],t._v(" "),l("div",{staticClass:"absolute del-box"},[l("el-popover",{attrs:{placement:"right",width:"300"},model:{value:t.visibleLabel,callback:function(e){t.visibleLabel=e},expression:"visibleLabel"}},[t._l(t.labelList,function(e,a){return l("div",{staticClass:"mb1"},[l("p",{staticClass:"colg"},[t._v(t._s(e.lebelName))]),t._v(" "),l("div",{staticClass:"col9 row label-box center bdb pb1"},t._l(e.lebelContent,function(s,i){return l("span",{staticClass:"col-lg-4 pointer",on:{click:function(e){t.choiceCustomLabel(a,i)}}},[-1!=e.lebelIndex&&e.lebelIndex==i?[l("el-button",{staticClass:"btn-hollow btn-small"},[t._v(t._s(s))])]:[t._v("\n\t\t\t\t\t\t\t\t\t\t"+t._s(s)+"\n\t\t\t\t\t\t\t\t\t")]],2)}))])}),t._v(" "),l("div",{staticClass:"center"},[l("span",{staticClass:"col9 mr2 pointer",on:{click:function(e){t.visibleLabel=!1}}},[t._v("取消")]),t._v(" "),l("span",{staticClass:"colp pointer",on:{click:t.confirmLabel}},[t._v("确认")])])],2)],1)],2),t._v(" "),l("el-form-item",{attrs:{label:"共享范围："}},[l("el-button",{class:1==t.ruleForm.state?"":"btn-hollow",on:{click:function(e){t.choiceState(1)}}},[t._v("自己独占")]),t._v(" "),l("el-button",{class:2==t.ruleForm.state?"":"btn-hollow",on:{click:function(e){t.choiceState(2)}}},[t._v("团队共享")])],1),t._v(" "),l("el-form-item",{attrs:{label:"提醒时间："}},[l("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期"},model:{value:t.time,callback:function(e){t.time=e},expression:"time"}})],1),t._v(" "),l("div",{staticClass:"center mt2 mb3"},[l("el-button",{staticClass:"linear5",on:{click:function(e){t.submitForm("ruleForm")}}},[t._v("保存")])],1)],2)],1)},staticRenderFns:[]}},661:function(t,e,l){var a=l(658);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);l(318)("cd8162e6",a,!0)},680:function(t,e,l){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=l(648),s=l(653),i=l.n(s),n=l(659),o=l.n(n);e.default={data:function(){return{title:"总客户池",currentTab:0,teamId:"",followCount:"",type:3,list:[],labelKeyList:[],labelList:[],showLable:!1,totalCount:0,showAdd:!0,count:{lose:0,share:0,monopolize:0},label:-1,labelKey:"",pageId:1,pageSize:10}},components:{vBreadNav:i.a,vAddCust:o.a},mounted:function(){this.teamId=a.a.getStore("teamId"),this.getList(),this.getCount(),this.getLabelList()},methods:{handleCurrentChange:function(t){this.pageId=t,this.getList()},getCount:function(){var t=this;t.postData({url:ApiUrl.getCountPool+"?teamId="+this.teamId,success:function(e){0==e.status&&(t.count=e.data)}})},getLabelList:function(){var t=this;t.postData({url:ApiUrl.getLabels,success:function(e){if(0==e.status&&null!=e.data){var l=e.data;for(var a in l)null!=l[a].lebelContent&&""!=l[a].lebelContent&&(l[a].lebelIndex=-1,l[a].lebelContent=l[a].lebelContent.split(",")),"状态"==l[a].lebelName&&(""==l[a].lebelContent&&(l[a].lebelContent=[]),l[a].lebelContent.push("成交"),l[a].lebelContent.push("流失"));t.labelList=l}}})},getList:function(t){var e=this;e.loading=!0;var l={pageId:this.pageId,pageSize:this.pageSize,teamId:this.teamId};t?(l.label=-1,l.type=3):l.type=this.type,this.labelKey&&(l.labelKey=this.labelKey),e.postData({url:ApiUrl.getCoustomer,data:l,success:function(t){if(0==t.status){e.nowIndex=0;var l=t.data.list;if(l.length>0){e.totalCount=t.data.totalNumber;for(var a in l)l[a].customUserLabel=null!=l[a].customUserLabel?JSON.parse(l[a].customUserLabel):null,l[a].customInfo=null!=l[a].customInfo?JSON.parse(l[a].customInfo):null;e.list=l}else e.list=[]}}})},choiceType:function(t){this.type=t,-1==t?this.getList(-1):this.getList()},refreshList:function(){this.type=3,this.getList()},switchLabel:function(){this.showLable=!0},delKey:function(t){this.labelKeyList.splice(t,1);var e="";for(var l in this.labelKeyList)e+=this.labelKeyList[l]+",";this.labelKey=e.substr(0,e.length-1),this.getList()},choiceCustomLabel:function(t,e){this.$set(this.labelList[t],"lebelIndex",e)},choiceLabel:function(){var t=this.labelList,e="",l=[];for(var a in t)-1!=t[a].lebelIndex&&void 0!=t[a].lebelIndex&&t[a].lebelContent[t[a].lebelIndex]&&(l.push(t[a].lebelContent[t[a].lebelIndex]),e+=t[a].lebelContent[t[a].lebelIndex]+",");this.labelKey=e.substr(0,e.length-1),this.labelKeyList=l,this.getList(),this.showLable=!1}}}},736:function(t,e,l){e=t.exports=l(90)(!1),e.push([t.i,".pool-list .col-lg-3[data-v-1d6ef9c1]{margin:0 20px 20px 10px;padding:0}",""])},775:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("div",{staticClass:"page-wrapper"},[l("div",{staticClass:"container-fluid"},[l("v-breadNav",{attrs:{tit:t.title,nav:t.title}}),t._v(" "),l("div",{staticClass:"mb2"},[l("el-button",{class:3==t.type?"":"btn-hollow",on:{click:function(e){t.choiceType(3)}}},[t._v("全部"+t._s(t.count.monopolize+t.count.share)+"人")]),t._v(" "),l("el-button",{class:1==t.type?"":"btn-hollow",on:{click:function(e){t.choiceType(1)}}},[t._v("我独占"+t._s(t.count.monopolize)+"人")]),t._v(" "),l("el-button",{class:2==t.type?"":"btn-hollow",on:{click:function(e){t.choiceType(2)}}},[t._v("团队共享"+t._s(t.count.share)+"人")]),t._v(" "),l("el-button",{class:-1==t.type?"":"btn-hollow",on:{click:function(e){t.choiceType(-1)}}},[t._v("标记流失"+t._s(t.count.lose)+"人")]),t._v(" "),l("div",{staticClass:"right relative"},[t._l(t.labelKeyList,function(e,a){return l("el-button",{staticClass:"btn-hollow",on:{click:function(e){t.delKey(a)}}},[l("i",{staticClass:"fa fa-times mr1"}),t._v(t._s(e)+"\n        \t\t\t")])}),t._v(" "),l("el-button",{on:{click:function(e){t.switchLabel()}}},[l("i",{staticClass:"fa fa-filter mr1"}),t._v("筛选")]),t._v(" "),l("el-button",{on:{click:t.refreshList}},[l("i",{staticClass:"fa fa-refresh mr1"}),t._v("刷新")])],2)],1),t._v(" "),l("div",[l("div",{staticClass:"card pool-list",staticStyle:{"min-height":"100%"}},[l("div",{staticClass:"card-body row"},[t._l(t.list,function(e,a){return l("div",{staticClass:"card col-lg-3",class:t.nowIndex==a?"hover":""},[l("div",{staticClass:"card-body"},[l("div",{staticClass:"ovh"},[l("span",{staticClass:"tip-name mr1 left"},[t._v(t._s(e.customName))]),t._v(" "),l("div",{},[l("div",{staticClass:"fontb mb1"},[t._v(t._s(e.customName)),l("span",{staticClass:"col9 font14 fontn ml1"},[t._v(t._s(e.customPhone))])]),t._v(" "),l("div",t._l(e.customUserLabel,function(e){return l("label",{staticClass:"label label-rounded mr1",style:{background:e.lebelColor}},[t._v(" \n\t\t\t\t\t\t\t\t\t\t\t"+t._s(e.lebelContent)+"\n\t\t\t\t\t\t\t\t\t\t")])}))])]),t._v(" "),e.kekeFollow?l("p",{staticClass:"col9 mt font14"},[t._v("\n    \t\t\t\t\t\t\t"+t._s(t._f("sortTimeYYYYMDHM")(e.kekeFollow.followModifyTime/1e3))+" "+t._s(e.kekeFollow.followRemark)+"\n    \t\t\t\t\t\t\t")]):t._e()])])}),t._v(" "),0==t.list.length?l("p",{staticClass:"col9 center"},[t._v("暂时没有此状态客户哦")]):t._e()],2)]),t._v(" "),l("div",{staticClass:"center mt2 mb2"},[l("el-pagination",{attrs:{"current-page":t.pageId,"page-size":t.pageSize,layout:"total, prev, pager, next",total:t.totalCount},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.pageId=e}}})],1)])],1),t._v(" "),l("el-dialog",{attrs:{title:"标签筛选",visible:t.showLable,width:"450px"},on:{"update:visible":function(e){t.showLable=e}}},[t._l(t.labelList,function(e,a){return l("div",{staticClass:"mb1"},[l("p",{staticClass:"colg"},[t._v(t._s(e.lebelName))]),t._v(" "),l("div",{staticClass:"col9 row label-box center bdb"},t._l(e.lebelContent,function(s,i){return l("span",{staticClass:"col-lg-4 pointer",on:{click:function(e){t.choiceCustomLabel(a,i)}}},[-1!=e.lebelIndex&&e.lebelIndex==i?[l("el-button",{staticClass:"btn-hollow"},[t._v(t._s(s))])]:[t._v("\n\t\t\t\t\t\t\t"+t._s(s)+"\n\t\t\t\t\t\t")]],2)}))])}),t._v(" "),l("div",{staticClass:"center"},[l("el-button",{staticClass:"linear5",on:{click:function(e){t.choiceLabel()}}},[t._v("确认")]),t._v(" "),l("el-button",{staticClass:"btn-hollow",on:{click:function(e){t.showLable=!1}}},[t._v("取消")])],1)],2)],1)},staticRenderFns:[]}},786:function(t,e,l){var a=l(736);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);l(318)("5d63e1b6",a,!0)}});